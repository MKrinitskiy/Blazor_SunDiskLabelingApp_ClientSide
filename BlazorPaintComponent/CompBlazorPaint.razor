@inherits CompBlazorPaint_Logic
@using System
@using System.Linq
@*@using System.Net.Http*@
@using Microsoft.JSInterop
@implements System.IDisposable
@inject IJSRuntime JsRuntime

<BPaintJsInterop_component></BPaintJsInterop_component>


<style>
    .outlined {
        border: 1px solid #ccc;
        border-radius: 5px;
        margin: 1rem;
        padding: 1rem;
        display: inline-block;
        background-color: #E9F4FF;
    }
    .outlined_info {
        border: 1px solid #ccc;
        border-radius: 5px;
        margin: 1rem;
        padding: 1rem;
        display: inline-block;
        background-color: #ffffff;
    }
    .tooltip {
        position: relative;
        display: inline-block;
        border-bottom: 1px dotted black;
    }
    .tooltip .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: #F4E9FF;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        margin-left: -60px;
        opacity: 0;
        transition: opacity 0.3s;
    }
    .tooltip .tooltiptext::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #555 transparent transparent transparent;
    }
    .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }
    .btn-with-icons {
        padding: 0.5rem;
    }
</style>


<div style="width: 100%">
    <table width="100%">
        
        <tr>
            <td style="width: 200px" valign="top">
                <div  id="OperationalModeGroup" class="outlined" style="line-height: 25px; width: 200px;">
                    <fieldset>
                        <legend>Mode</legend>
                        <button id="btnSelectMode" title="Select mode" class="@btnSelectMode_CSSclass" style="cursor: default" @onclick="btnSelectMode_onClick">
                            <svg id="btnSelectModeSVGicon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="42px" height="42px" fill="black" stroke="black" viewBox="0 0 512 512" style="enable-background:new 0 0 512 512 ;" xml:space="preserve">
                            <path d="M507.606,422.754l-87.508-87.508l42.427-42.426c3.676-3.676,5.187-8.993,3.992-14.053s-4.923-9.14-9.855-10.784   l-36.7-12.233c0.012-0.25,0.038-0.497,0.038-0.75v-60c0-8.284-6.716-15-15-15s-15,6.716-15,15v50.762L202.104,183.13   c-5.388-1.798-11.333-0.394-15.35,3.624c-4.018,4.018-5.421,9.96-3.624,15.35L245.762,390H195c-8.284,0-15,6.716-15,15   s6.716,15,15,15h60c0.253,0,0.499-0.025,0.749-0.038l12.233,36.7c1.645,4.932,5.725,8.661,10.784,9.855   c5.06,1.196,10.377-0.315,14.053-3.992l42.427-42.426l87.508,87.507c2.929,2.929,6.768,4.394,10.606,4.394   s7.678-1.464,10.606-4.394l63.64-63.64C513.465,438.109,513.465,428.612,507.606,422.754z M433.36,475.787l-87.508-87.507   c-5.857-5.858-15.356-5.858-21.213,0l-35.871,35.871l-67.691-203.073l203.073,67.691l-35.871,35.871   c-5.853,5.852-5.858,15.356,0,21.213l87.508,87.508L433.36,475.787z" />
                            <path d="M135,0h-30c-8.284,0-15,6.716-15,15s6.716,15,15,15h30c8.284,0,15-6.716,15-15S143.284,0,135,0z" />
                            <path d="M195,30h30c8.284,0,15-6.716,15-15s-6.716-15-15-15h-30c-8.284,0-15,6.716-15,15S186.716,30,195,30z" />
                            <path d="M285,30h30c8.284,0,15-6.716,15-15s-6.716-15-15-15h-30c-8.284,0-15,6.716-15,15S276.716,30,285,30z" />
                            <path d="M135,390h-30c-8.284,0-15,6.716-15,15s6.716,15,15,15h30c8.284,0,15-6.716,15-15S143.284,390,135,390z" />
                            <path d="M375,30h15v15c0,8.284,6.716,15,15,15s15-6.716,15-15V15c0-8.284-6.716-15-15-15h-30c-8.284,0-15,6.716-15,15   S366.716,30,375,30z" />
                            <path d="M45,0H15C6.716,0,0,6.716,0,15v30c0,8.284,6.716,15,15,15s15-6.716,15-15V30h15c8.284,0,15-6.716,15-15S53.284,0,45,0z" />
                            <path d="M15,150c8.284,0,15-6.716,15-15v-30c0-8.284-6.716-15-15-15S0,96.716,0,105v30C0,143.284,6.716,150,15,150z" />
                            <path d="M15,240c8.284,0,15-6.716,15-15v-30c0-8.284-6.716-15-15-15s-15,6.716-15,15v30C0,233.284,6.716,240,15,240z" />
                            <path d="M15,330c8.284,0,15-6.716,15-15v-30c0-8.284-6.716-15-15-15s-15,6.716-15,15v30C0,323.284,6.716,330,15,330z" />
                            <path d="M405,90c-8.284,0-15,6.716-15,15v30c0,8.284,6.716,15,15,15s15-6.716,15-15v-30C420,96.716,413.284,90,405,90z" />
                            <path d="M45,390H30v-15c0-8.284-6.716-15-15-15s-15,6.716-15,15v30c0,8.284,6.716,15,15,15h30c8.284,0,15-6.716,15-15   S53.284,390,45,390z" />
                            </svg>
                        </button>
                        &nbsp;
                        <button id="btnDrawMode" title="Labeling mode" class="@btnDrawMode_CSSclass" style="cursor: default" @onclick="btnDrawMode_onClick">
                            <svg id="btnDrawModeSVGicon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="42px" height="42px" fill="black" stroke="black" viewBox="0 0 60.017 60.017" style="enable-background:new 0 0 60.017 60.017;" xml:space="preserve">
                                <path d="M59.144,3.731l-2.85-2.851c-1.164-1.161-3.057-1.162-4.221,0.001l-3.126,3.126H0v56h56V11.097l0.305-0.305l0,0l2.839-2.839 
                                        C60.308,6.789,60.308,4.895,59.144,3.731z M20.047,36.759l3.22,3.22l-4.428,1.208L20.047,36.759z M52.062,12.206L47.82,7.964
                                        l1.414-1.414l4.243,4.242L52.062,12.206z M50.648,13.62L25.192,39.076l-4.242-4.242L46.406,9.378L50.648,13.62z M54,13.097v44.91H2
                                        v-52h44.947L18.829,34.127l-0.188,0.188l-2.121,7.779l-1.226,1.226c-0.391,0.391-0.391,1.023,0,1.414
                                        c0.195,0.195,0.451,0.293,0.707,0.293s0.512-0.098,0.707-0.293l1.226-1.226l7.779-2.123l26.351-26.35h0l0.447-0.447L54,13.097z
                                        M57.73,6.539l-2.839,2.839l-4.243-4.243l2.839-2.839c0.384-0.384,1.009-0.383,1.393,0l2.85,2.85
                                        C58.114,5.529,58.114,6.155,57.73,6.539z"/>
                            </svg>
                        </button>
                    </fieldset>
                </div>
            </td>
            <td style="width: 800px" valign="top">
                <div id="SelectionAndEditActions" class="outlined" style="line-height: 25px; width: 80%; height: 90%">
                    <fieldset>
                        @*
                        // TODO: Commands list appearance
                        // category=Appearance issue=none estimate=3h
                        // The block "Commands": make it pretty. Either it is too wide or too short at the moment
                        *@
                        <legend>Commands</legend>
                        <button id="btnSelectAll" class="btn btn-primary btn-with-icons" title="Select all" style="cursor: default" @onclick="btnSelectAll_onClick" disabled="@btnSelectAllDisabled">
                            @*
                            // TODO: Change the icon of the SelectAll button
                            // category=Appearance issue=none estimate=1h
                            // The purpose of the icon is not obvious
                            *@
                            <svg id="btnSelectAllSVGicon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="42px" height="42px" x="0px" y="0px" viewBox="0 0 512 512" fill="black" stroke="black" style="enable-background:new 0 0 512 512;" xml:space="preserve">
                            <rect width="32" height="32" /><rect x="80" width="32" height="32" /><rect x="160" width="32" height="32" /><rect x="240" width="32" height="32" /><rect x="320" width="32" height="32" />
                            <rect x="400" width="32" height="32" /><rect x="480" width="32" height="32" /><rect y="480" width="32" height="32" /><rect x="80" y="480" width="32" height="32" /><rect x="160" y="480" width="32" height="32" />
                            <rect x="240" y="480" width="32" height="32" /><rect x="320" y="480" width="32" height="32" /><rect x="400" y="480" width="32" height="32" /><rect y="400" width="32" height="32" />
                            <rect y="320" width="32" height="32" /><rect y="240" width="32" height="32" /><rect y="160" width="32" height="32" /><rect y="80" width="32" height="32" /><rect x="480" y="400" width="32" height="32" />
                            <rect x="480" y="320" width="32" height="32" /><rect x="480" y="240" width="32" height="32" /><rect x="480" y="160" width="32" height="32" /><rect x="480" y="80" width="32" height="32" />
                            <rect x="480" y="480" width="32" height="32" />
                            <path d="M96,416h320V96H96V416z M128,128h256v256H128V128z" />
                            </svg>
                        </button>
                        <button id="btnDeleteSelectedObjects" class="btn btn-primary btn-with-icons" title="Delete selected" style="cursor: default" @onclick="btnDeleteSelectedObjects_onClick" disabled="@btnDeleteSelectedDisabled">
                            @*
                            // TODO: Change the icon of the SelectAll button
                            // category=Appearance issue=none estimate=1h
                            // The purpose of the icon is not obvious
                            *@
                            <svg id="btnDeleteSelectedObjectsSVGicon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="42px" height="42px" x="0px" y="0px" viewBox="0 0 512 512" fill="black" stroke="black" style="enable-background:new 0 0 512 512;" xml:space="preserve">
                            <path d="M0,464c0,26.51,21.49,48,48,48h224c26.51,0,48-21.49,48-48V128H0V464z M32,160h256v304c0,8.837-7.163,16-16,16H48 c-8.837,0-16-7.163-16-16V160z" />

                            <rect x="192" y="192" width="32" height="256" /><rect x="96" y="192" width="32" height="256" /><path d="M224,0H96v64H0v32h320V64h-96V0z M192,64h-64V32h64V64z" /><rect x="352" y="224" width="96" height="32" />

                            <rect x="480" y="224" width="32" height="32" /><rect x="384" y="320" width="64" height="32" /><rect x="480" y="320" width="32" height="32" />

                            </svg>
                        </button>
                    </fieldset>
                </div>
            </td>
            <td>
                <div id="InfoText" class="outlined_info" style="line-height: 25px; width: 100%; height: 90%">
                    <label>
                        Current operational mode: @CurrOperationalMode
                    </label>
                    <br />
                    <label>
                        Current selection mode: @CurrSelectionMode
                    </label>
                    <br />
                    <label>
                        Current mode: @CurrPaintMode
                    </label>
                    <br />
                    <label>
                        Current object editing: @strCurrentlyEditingObject()
                    </label>
                    <br />
                    <label>
                        Current mouse location: @strCurrMouseLocation
                    </label>
                    <br />
                    <label>
                        Current SVG area location: @strCurrSVGareaLocation
                    </label>
                    <br />
                    <label>
                        Vertices count: @(VerticesList.Count)
                    </label>
                    <br />
                    <label>
                        bpSelectionRectangle is null: @(bpSelectionRectangle == null)
                    </label>
                </div>
            </td>
        </tr>
        @*
        <tr>
            <td colspan="2" valign="bottom">
                // DONE: Leave Circle category of labels only
                // category=Appearance issue=none estimate=1h
                // Just for this project only. So there will be no need for a selector of labels type
                <input type="radio" name="mode" value="2" checked="@(FigureCode == 2)" @onchange="(() => FigureCode = 2)" /> Line
                <input type="radio" name="mode" value="3" checked="@(FigureCode == 3)" @onchange="(() => FigureCode = 3)" /> Vertex
                <input type="radio" name="mode" value="4" checked="@(FigureCode == 4)" @onchange="(() => FigureCode = 4)" /> Circle
                <input type="radio" name="mode" value="5" checked="@(FigureCode == 5)" @onchange="(() => FigureCode = 5)" /> Ellipse
            </td>
            <td>&nbsp;</td>
        </tr>
        *@
        <tr>
            <td colspan="2">
                @*
                // TODO: Remove btnStartWebAPIsession button; make session to be initialized lazy.
                // category=Client-server-interface issue=none estimate=6h
                *@
                <button class="btn btn-primary" id="btnStartWebAPIsession" style="cursor: default" @onclick="btnStartWebAPIsession_onClick">Start web API session</button>
                &nbsp;
                <button class="btn btn-primary btn-with-icons" id="btnPrevExample" style="cursor: default" title="Previous example" @onclick="btnPrevExample_onClick">
                    <svg version="1.1" id="btnPrevExampleSVGicon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="42px" height="42px" x="0px" y="0px" viewBox="0 0 219.151 219.151" fill="black" stroke="black" style="enable-background:new 0 0 219.151 219.151;" xml:space="preserve">
                        <g>
                            <path d="M109.576,219.151c60.419,0,109.573-49.156,109.573-109.576C219.149,49.156,169.995,0,109.576,0S0.002,49.156,0.002,109.575
                                  C0.002,169.995,49.157,219.151,109.576,219.151z M109.576,15c52.148,0,94.573,42.426,94.574,94.575
                                  c0,52.149-42.425,94.575-94.574,94.576c-52.148-0.001-94.573-42.427-94.573-94.577C15.003,57.427,57.428,15,109.576,15z"/>
                            <path d="M94.861,156.507c2.929,2.928,7.678,2.927,10.606,0c2.93-2.93,2.93-7.678-0.001-10.608l-28.82-28.819l83.457-0.008
                                  c4.142-0.001,7.499-3.358,7.499-7.502c-0.001-4.142-3.358-7.498-7.5-7.498l-83.46,0.008l28.827-28.825
                                  c2.929-2.929,2.929-7.679,0-10.607c-1.465-1.464-3.384-2.197-5.304-2.197c-1.919,0-3.838,0.733-5.303,2.196l-41.629,41.628
                                  c-1.407,1.406-2.197,3.313-2.197,5.303c0.001,1.99,0.791,3.896,2.198,5.305L94.861,156.507z"/>
                        </g>
                    </svg>
                </button>
                @*
                // DONE: Change the icon of the btnPrevExample button
                // category=Appearance issue=none estimate=1h
                // Chenge text to icon
                *@
                @*<button class="btn btn-primary" style="cursor: default" @onclick="btnSaveCurrExampleLabels_onClick">Save labels</button>*@
                <button class="btn btn-primary btn-with-icons" id="btnNextExample" style="cursor: default" title="Next example" @onclick="btnNextExample_onClick">
                    <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="42px" height="42px" x="0px" y="0px" viewBox="0 0 219.15 219.15" style="enable-background:new 0 0 219.15 219.15;" fill="black" stroke="black" xml:space="preserve">
                        <g>
                            <path d="M109.575,0C49.156,0,0.002,49.155,0.002,109.576c0,60.419,49.154,109.574,109.573,109.574s109.573-49.155,109.573-109.574
                                    C219.148,49.155,169.994,0,109.575,0z M109.575,204.15c-52.148,0-94.573-42.426-94.573-94.574C15.002,57.427,57.427,15,109.575,15
                                    s94.573,42.427,94.573,94.576C204.148,161.725,161.723,204.15,109.575,204.15z"/>
                            <path d="M124.29,62.645c-2.929-2.928-7.678-2.928-10.606,0c-2.929,2.93-2.929,7.678,0,10.607l28.821,28.82l-83.457,0.008
                                    c-4.143,0-7.5,3.358-7.5,7.501c0,4.142,3.358,7.499,7.5,7.499l83.46-0.008l-28.827,28.825c-2.929,2.929-2.929,7.678,0,10.606
                                    c1.464,1.465,3.384,2.197,5.303,2.197c1.919,0,3.839-0.732,5.303-2.196l41.629-41.627c1.407-1.407,2.197-3.314,2.197-5.304
                                    c0-1.989-0.79-3.897-2.197-5.304L124.29,62.645z"/>
                        </g>
                    </svg>
                </button>
                @*
                // DONE: Change the icon of the btnNextExample button
                // category=Appearance issue=none estimate=1h
                // Chenge text to icon
                *@
                <br />
                <label>web API session started: @webAPIsessionStarted</label>
            </td>
            <td>&nbsp;</td>
        </tr>
        @*
        <tr>
            <td colspan="2">
                <br />
                <input bind="@Color1" type="color" @oninput="cmd_ColorChange" />

                <CompUsedColors @ref="Curr_CompUsedColors" @ref:suppressField parent="@this"></CompUsedColors>
            </td>
            <td>&nbsp;</td>
        </tr>
        *@
        <tr>
            <td colspan="2" valign="top">
                <div style="position: absolute">
                    <img id="BackgroundImage" src="@CurrentBackgroundImageURI" width="1200" height="1200" style="position: absolute">
                </div>

                <div style="position: relative; background-color: rgba(0, 0, 0, 0.0)" id="PaintArea1" width="1200" height="1200" @onmousedown="onMouseDown" @onmousemove="onMouseMove" @onmouseup="onMouseUp">
                    <CompMySVG @ref="Curr_CompMySVG" @ref:suppressField parent="@this" par_width="1200" par_height="1200"></CompMySVG>
                </div>
            </td>
            
            <td valign="top">
                <label>Objects List</label>
                <br />
                @*
                // TODO: Objects list appearance
                // category=Appearance issue=none estimate=2h
                // The label "Objects list": align it with the labels of service information like "Current operational mode" etc.
                // Rename "Objects list" to "Labels list" or "Labels"
                // Make the list of labels visually the same as service information: div, outline
                *@
                @if (ObjectsList.Any())
                {
                    @foreach (var obj in ObjectsList.OrderBy(x => x.SequenceNumber))
                    {
                        <CompListItem Par_ID="@obj.ObjectID" parent="@this"></CompListItem>
                        <br />
                    }

                }
            </td>
        </tr>
    </table>
</div>
